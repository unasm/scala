
import com.aispeech.hw
import org.apache.spark.sql.Row
import org.scalatest.FunSuite

/**
  * Created by tianyi on 14/02/2018.
  */
class MainTest extends FunSuite {
//  test("hw.parseJson") {
//    assert(hw.parseJson("{\"eventName\":\"非测试脚本并且经过微信认证，先回复success\",\"sessionId\":\"oTiyzwuVDWiE-xwZQxnKsjDMUeq41518163533\",//\"recordId\":\"012c9f80-0d70-11e8-be1a-4148fcdbc116\",\"contextId\":\"\",\"project\":\"kefu\",\"platId\":\"2\",\"solutionId\":\"\",\"module\":\"open-wechat\",//\"version\":\"0.01\",\"logTime\":\"2018-02-09T08:38:16.597\",\"level\":\"debug\",\"message\":{}}") == Row())
//
//    assert(hw.parseJson("{\"eventName\":\"正在请求更新access_token\",\"sessionId\":\"oTiyzwp_utmA6LQQXmGPDVKG0j5w1518165496\",\"recordId\":\"92d59b40-0d74-11e8-be1a-4148fcdbc116\",\"contextId\":\"\",\"project\":\"kefu\",\"platId\":\"2\",\"solutionId\":\"\",\"module\":\"open-wechat\",\"version\":\"0.01\",\"logTime\":\"2018-02-09T08:38:17.040\",\"level\":\"debug\",\"message\":{}}") == Row())

//    assert(hw.parseJson("{\"eventName\":\"sys_input_output\",\"sessionId\":\"oTiyzwp_utmA6LQQXmGPDVKG0j5w1518165496\",\"recordId\":\"92d59b40-0d74-11e8-be1a-4148fcdbc116\",//\"contextId\":\"\",\"project\":\"kefu\",\"platId\":\"2\",\"solutionId\":\"\",\"module\":\"open-wechat\",\"version\":\"0.01\",\"logTime\":\"2018-02-09T08:38:16.600\",//\"level\":\"info\",\"beginTime\":\"2018-02-09T08:38:16.564\",\"endTime\":\"2018-02-09T08:38:16.600\",\"timeCost\":36,\"message\":{\"method\":\"POST\",\"url\":\"/appid/wxdca33ce992ed557e?signature=924b94b4e46d7d072e0e1313360a02ef279dc6b6&timestamp=1518165496&nonce=280782772&openid=oTiyzwp_utmA6LQQXmGPDVKG0j5w&encrypt_type=aes&msg_signature=2bf0880f2b26e4b54ecf7a010ce400d9114fd6f7\",\"header\":{\"host\":\"ba.dui.ai\",\"connection\":\"close\",\"x-real-ip\":\"140.207.54.80\",\"x-forwarded-for\":\"140.207.54.80\",\"x-forwarded-host\":\"ba.dui.ai\",\"x-forwarded-port\":\"443\",\"x-forwarded-proto\":\"https\",\"x-original-uri\":\"/appid/wxdca33ce992ed557e?signature=924b94b4e46d7d072e0e1313360a02ef279dc6b6&timestamp=1518165496&nonce=280782772&openid=oTiyzwp_utmA6LQQXmGPDVKG0j5w&encrypt_type=aes&msg_signature=2bf0880f2b26e4b54ecf7a010ce400d9114fd6f7\",\"x-scheme\":\"https\",\"content-length\":\"578\",\"user-agent\":\"Mozilla/4.0\",\"accept\":\"*/*\",\"pragma\":\"no-cache\",\"content-type\":\"text/xml\"},\"input\":\"\",\"output\":{\"status\":200,\"message\":\"OK\",\"header\":{\"content-type\":\"text/plain; charset=utf-8\",\"content-length\":\"7\"}}}}") == Row())

    //assert(hw.parseJson("{\"eventName\":\"access_token已经刷新\",\"sessionId\":\"oTiyzwp_utmA6LQQXmGPDVKG0j5w1518165496\",\"recordId\":\"92d59b40-0d74-11e8-be1a-4148fcdbc116\",\"contextId\":\"\",\"project\":\"kefu\",\"platId\":\"2\",\"solutionId\":\"\",\"module\":\"open-wechat\",\"version\":\"0.01\",\"logTime\":\"2018-02-09T08:38:17.337\",\"level\":\"info\",\"message\":[{\"authorizer_access_token\":\"6_wz0uKEZz2QKVvQrJWEWcI9-NprkrGLd34bKqSpwWVIoObAnMrOot7sZPgcXMRJ7h8ospl2t5Obio4uJIM1S-yJNEBb3jfAn3EiBgjaE9vHGvDgHJAVjqL_zHLf9zbx3znK1-mbdrv3e4hGDVZHWfALDFNC\",\"expires_in\":7200,\"authorizer_refresh_token\":\"refreshtoken@@@dl5Bvvl6ra4487Rofaedn1Y2fvH_djY3KTFPsQZ797Y\"},{\"authorizer_access_token\":\"6_wz0uKEZz2QKVvQrJWEWcI9-NprkrGLd34bKqSpwWVIoObAnMrOot7sZPgcXMRJ7h8ospl2t5Obio4uJIM1S-yJNEBb3jfAn3EiBgjaE9vHGvDgHJAVjqL_zHLf9zbx3znK1-mbdrv3e4hGDVZHWfALDFNC\",\"expires_in\":7200,\"authorizer_refresh_token\":\"refreshtoken@@@dl5Bvvl6ra4487Rofaedn1Y2fvH_djY3KTFPsQZ797Y\"}]}") == Row())
//  }

  test("hw.parseJsonMain") {
    //assert(hw.parseJsonMain("{\"eventName\":\"access_token已经刷新\",\"sessionId\":\"oTiyzwp_utmA6LQQXmGPDVKG0j5w1518165496\",\"recordId\":\"92d59b40-0d74-11e8-be1a-4148fcdbc116\",\"contextId\":\"\",\"project\":\"kefu\",\"platId\":\"2\",\"solutionId\":\"\",\"module\":\"open-wechat\",\"version\":\"0.01\",\"logTime\":\"2018-02-09T08:38:17.337\",\"level\":\"info\",\"message\":[{\"authorizer_access_token\":\"6_wz0uKEZz2QKVvQrJWEWcI9-NprkrGLd34bKqSpwWVIoObAnMrOot7sZPgcXMRJ7h8ospl2t5Obio4uJIM1S-yJNEBb3jfAn3EiBgjaE9vHGvDgHJAVjqL_zHLf9zbx3znK1-mbdrv3e4hGDVZHWfALDFNC\",\"expires_in\":7200,\"authorizer_refresh_token\":\"refreshtoken@@@dl5Bvvl6ra4487Rofaedn1Y2fvH_djY3KTFPsQZ797Y\"},{\"authorizer_access_token\":\"6_wz0uKEZz2QKVvQrJWEWcI9-NprkrGLd34bKqSpwWVIoObAnMrOot7sZPgcXMRJ7h8ospl2t5Obio4uJIM1S-yJNEBb3jfAn3EiBgjaE9vHGvDgHJAVjqL_zHLf9zbx3znK1-mbdrv3e4hGDVZHWfALDFNC\",\"expires_in\":7200,\"authorizer_refresh_token\":\"refreshtoken@@@dl5Bvvl6ra4487Rofaedn1Y2fvH_djY3KTFPsQZ797Y\"}]}") == Row())

    assert(hw.parseJsonMain("{\"eventName\":\"sys_input_output\",\"sessionId\":\"oTiyzwp_utmA6LQQXmGPDVKG0j5w1518165496\",\"recordId\":\"92d59b40-0d74-11e8-be1a-4148fcdbc116\",\"contextId\":\"\",\"project\":\"kefu\",\"platId\":\"2\",\"solutionId\":\"\",\"module\":\"open-wechat\",\"version\":\"0.01\",\"logTime\":\"2018-02-09T08:38:16.600\",\"level\":\"info\",\"beginTime\":\"2018-02-09T08:38:16.564\",\"endTime\":\"2018-02-09T08:38:16.600\",\"timeCost\":36,\"message\":{\"method\":\"POST\",\"url\":\"/appid/wxdca33ce992ed557e?signature=924b94b4e46d7d072e0e1313360a02ef279dc6b6&timestamp=1518165496&nonce=280782772&openid=oTiyzwp_utmA6LQQXmGPDVKG0j5w&encrypt_type=aes&msg_signature=2bf0880f2b26e4b54ecf7a010ce400d9114fd6f7\",\"header\":{\"host\":\"ba.dui.ai\",\"connection\":\"close\",\"x-real-ip\":\"140.207.54.80\",\"x-forwarded-for\":\"140.207.54.80\",\"x-forwarded-host\":\"ba.dui.ai\",\"x-forwarded-port\":\"443\",\"x-forwarded-proto\":\"https\",\"x-original-uri\":\"/appid/wxdca33ce992ed557e?signature=924b94b4e46d7d072e0e1313360a02ef279dc6b6&timestamp=1518165496&nonce=280782772&openid=oTiyzwp_utmA6LQQXmGPDVKG0j5w&encrypt_type=aes&msg_signature=2bf0880f2b26e4b54ecf7a010ce400d9114fd6f7\",\"x-scheme\":\"https\",\"content-length\":\"578\",\"user-agent\":\"Mozilla/4.0\",\"accept\":\"*/*\",\"pragma\":\"no-cache\",\"content-type\":\"text/xml\"},\"input\":\"\",\"output\":{\"status\":200,\"message\":\"OK\",\"header\":{\"content-type\":\"text/plain; charset=utf-8\",\"content-length\":\"7\"}}}}") == Row())
  }
}
